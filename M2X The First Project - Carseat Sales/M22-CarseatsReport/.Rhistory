knitr::opts_chunk$set(echo = TRUE)
library(ISLR)
library(dplyr)
library(ggplot2)
str(Carseats)
xyPlot <-
ggplot(data = Carseats, aes(x = Advertising, y = Sales))
print(xyPlot)
xyPlot <-
ggplot(data = Carseats, aes(x = Advertising, y = Sales)) +
geom_point()
print(xyPlot)
xyPlot <- ggplot(data = Carseats, aes(x = Advertising, y = Sales)) + geom_point()
print(xyPlot)
colnames(Carseats)
summary(Carseats$Income)
length(summary(Carseats$Income))
summary(Carseats)
class(summary(Carseats))
summary(Carseats)
summary(Carseats)$Sales
summary(Carseats)
a <- summary(Carseats)
dim(a)
head(a)
a[,1]
names(a)
colnames(a)
summary(Carseats$Income)
summary(Carseats$Income)[c(2,3,5)]
generateQuartile <- function(x) {
return(summary(x)[c(2,3,5)])
}
generateQuartile(Carseats$Income))
generateQuartile(Carseats$Income)
Carseats <- Carseats %>%
mutate(IncomeF =
ifelse(Income < generateQuartile[1], "Q1",
ifelse(Income < generateQuartile[2], "Q2",
ifelse(Income < generateQuartile[3], "Q3", "Q4"))))
Carseats <- Carseats %>%
mutate(IncomeF =
ifelse(Income < generateQuartile(Income)[1], "Q1",
ifelse(Income < generateQuartile(Income)[2], "Q2",
ifelse(Income < generateQuartile(Income)[3], "Q3", "Q4"))))
head(Carseats)
generateQuartile <- function(x) {
return(summary(x)[c(2,3,5)])
}
Carseats <- Carseats %>%
mutate(IncomeF =
ifelse(Income < generateQuartile(Income)[1], "Q1",
ifelse(Income < generateQuartile(Income)[2], "Q2",
ifelse(Income < generateQuartile(Income)[3], "Q3", "Q4")))) %>%
mutate(PopulationF =
ifelse(Population < generateQuartile(Population)[1], "Q1",
ifelse(Population < generateQuartile(Population)[2], "Q2",
ifelse(Population < generateQuartile(Population)[3], "Q3", "Q4")))) %>%
mutate(AgeF =
ifelse(Age < generateQuartile(Age)[1], "Q1",
ifelse(Age < generateQuartile(Age)[2], "Q2",
ifelse(Age < generateQuartile(Age)[3], "Q3", "Q4")))) %>%
mutate(EducationF =
ifelse(Education < generateQuartile(Education)[1], "Q1",
ifelse(Education < generateQuartile(Education)[2], "Q2",
ifelse(Education < generateQuartile(Education)[3], "Q3", "Q4"))))
head(Carseats)
xyPlot + facet_wrap(~ PopulationF)
# Create factor type
generateQuartile <- function(x) {
return(summary(x)[c(2,3,5)])
}
Carseats <- Carseats %>%
mutate(IncomeF =
ifelse(Income < generateQuartile(Income)[1], "Q1",
ifelse(Income < generateQuartile(Income)[2], "Q2",
ifelse(Income < generateQuartile(Income)[3], "Q3", "Q4")))) %>%
mutate(PopulationF =
ifelse(Population < generateQuartile(Population)[1], "Q1",
ifelse(Population < generateQuartile(Population)[2], "Q2",
ifelse(Population < generateQuartile(Population)[3], "Q3", "Q4")))) %>%
mutate(AgeF =
ifelse(Age < generateQuartile(Age)[1], "Q1",
ifelse(Age < generateQuartile(Age)[2], "Q2",
ifelse(Age < generateQuartile(Age)[3], "Q3", "Q4")))) %>%
mutate(EducationF =
ifelse(Education < generateQuartile(Education)[1], "Q1",
ifelse(Education < generateQuartile(Education)[2], "Q2",
ifelse(Education < generateQuartile(Education)[3], "Q3", "Q4"))))
xyPlot + facet_wrap(~ IncomeF)
xyPlot
head(Carseats)
xyPlot + facet_wrap(~ IncomeF)
xyPlot <-
ggplot(data = Carseats, aes(x = Advertising, y = Sales)) +
geom_point()
xyPlot + facet_wrap(~ IncomeF)
xyPlot + facet_wrap(~ Urban)
xyPlot + facet_wrap(~ US)
xyPlot + facet_wrap(~ Urban, labeller = "x")
xyPlot + facet_wrap(~ Urban) + title("facet by Urban")
xyPlot + facet_wrap(~ Urban) + theme(title = "by Urban")
xyPlot + facet_wrap(~ Urban) + ggtitle("by Urban")
xyPlot + facet_wrap(~ IncomeF) + labs(title = "by IncomeF")
generateQuartile(Income)
generateQuartile(Carseats$Income)
Carseats %>% generateQuartile(Income) %>% as.numeric()
Carseats %>% generateQuartile(Income)
generateQuartile(Carseats$Income)
generateQuartile(Carseats$Income) %>% as.numeric()
xyPlot + facet_wrap(~ IncomeF) +
labs(title = "by IncomeF",
subtitle = generateQuartile(Carseats$Income) %>% as.numeric())
generateQuartile(Carseats$Income) %>% as.numeric()
generateQuartile(Carseats$Income) %>% as.numeric() %>% paste()
xyPlot + facet_wrap(~ IncomeF) +
labs(title = "by IncomeF",
subtitle = generateQuartile(Carseats$Income) %>% as.numeric() %>% paste(collapse = ","))
xyPlot <-
ggplot(data = Carseats, aes(x = Advertising, y = Sales)) +
geom_point() # Let xyPlot to update the dataset
xyPlot + facet_wrap(~ IncomeF) +
labs(title = "by IncomeF",
subtitle = generateQuartile(Carseats$Income) %>% as.numeric() %>% paste(collapse = ","))
xyPlot + facet_wrap(~ PopulationF) +
labs(title = "by PopulationF",
subtitle = generateQuartile(Carseats$Population) %>% as.numeric() %>% paste(collapse = ","))
xyPlot + facet_wrap(~ AgeF) +
labs(title = "by AgeF",
subtitle = generateQuartile(Carseats$Age) %>% as.numeric() %>% paste(collapse = ","))
xyPlot + facet_wrap(~ EducationF) +
labs(title = "by EducationF",
subtitle = generateQuartile(Carseats$Education) %>% as.numeric() %>% paste(collapse = ","))
a <- "Education"
xyPlot + facet_wrap(~ paste(a,"F"))
xyPlot + facet_wrap(~ paste0(a,"F"))
xyPlot + facet_wrap(~ as.name(paste0(a,"F")))
paste0(a,"F")
xyPlot + facet_wrap(~ as.symbol(paste0(a,"F")))
original_string <- c("x=123", "y=456")
original_string <- c("x=123", "y=456")
pairs <- strsplit(original_string, "=")
lapply(pairs, function(x) assign(x[1], as.numeric(x[2]), envir = globalenv()))
ls()
paste0("~ ", a, "F")
as.formula(paste0("~ ", a, "F"))
as.formula(paste("~", a, "F"))
as.formula(paste("~", paste0(a, "F")))
xyPlot + facet_wrap(as.formula(paste0("~", a, "F")))
var <- "Education"
paste("by", var)
paste0("by ", var, "F")
generateQuartile(as.formula(paste("Carseats$", var))) %>%
as.numeric() %>% paste(collapse = ",")
as.formula(paste("Carseats$", var))
paste("Carseats$", var)
as.formula(paste0("Carseats$", var))
paste0("Carseats$", var)
Carseats$Education
generateQuartile(as.name(paste0("Carseats$", var)))
as.name
xyPlot + facet_wrap(as.formula(paste0("~", var, "F"))) +
labs(title = paste0("by ", var, "F"),
subtitle = generateQuartile(as.name(paste0("Carseats$", var))) %>%
as.numeric() %>% paste(collapse = ",")
)
xyPlot + facet_wrap(as.formula(paste0("~", var, "F"))) +
labs(title = paste0("by ", var, "F"),
subtitle = generateQuartile(as.symbol(paste0("Carseats$", var))) %>%
as.numeric() %>% paste(collapse = ","))
generateQuartile(as.name(paste0("Carseats$", var)))
var.name = "x"
assign(var.name, 5)
eval(as.symbol(var.name))
var.name = "x"
x
eval(parse(text=paste0("Carseats$", var)))
xyPlot + facet_wrap(as.formula(paste0("~", var, "F"))) +
labs(title = paste0("by ", var, "F"),
subtitle = generateQuartile(eval(parse(text=paste0("Carseats$", var)))) %>%
as.numeric() %>% paste(collapse = ","))
xyPlot + facet_wrap(as.formula(paste0("~", var, "F"))) +
labs(title = paste0("by ", var, "F"),
subtitle = generateQuartile(eval(parse(paste0("Carseats$", var)))) %>%
as.numeric() %>% paste(collapse = ","))
xyPlot + facet_wrap(as.formula(paste0("~", var, "F"))) +
labs(title = paste0("by ", var, "F"),
subtitle = generateQuartile(eval(parse(text=paste0("Carseats$", var)))) %>%
as.numeric() %>% paste(collapse = ","))
variables <- c("Income", "Population", "Age", "Education")
for (var in variables) {
xyPlot +
facet_wrap(as.formula(paste0("~", var, "F"))) +
labs(title =
paste0("by ", var, "F"),
subtitle =
generateQuartile(eval(parse(text=paste0("Carseats$", var)))) %>%
as.numeric() %>% paste(collapse = ","))
}
variables <- c("Income", "Population", "Age", "Education")
for (var in variables) {
xyPlot +
facet_wrap(as.formula(paste0("~", var, "F"))) +
labs(title =
paste0("by ", var, "F"),
subtitle =
generateQuartile(eval(parse(text=paste0("Carseats$", var)))) %>%
as.numeric() %>% paste(collapse = ","))
}
var
xyPlot +
facet_wrap(as.formula(paste0("~", var, "F"))) +
labs(title =
paste0("by ", var, "F"),
subtitle =
generateQuartile(eval(parse(text=paste0("Carseats$", var)))) %>%
as.numeric() %>% paste(collapse = ","))
var <- "Income"
xyPlot +
facet_wrap(as.formula(paste0("~", var, "F"))) +
labs(title =
paste0("by ", var, "F"),
subtitle =
generateQuartile(eval(parse(text=paste0("Carseats$", var)))) %>%
as.numeric() %>% paste(collapse = ","))
variables <- c("Income", "Population", "Age", "Education")
for (var in variables) {
a <- xyPlot +
facet_wrap(as.formula(paste0("~", var, "F"))) +
labs(title =
paste0("by ", var, "F"),
subtitle =
generateQuartile(eval(parse(text=paste0("Carseats$", var)))) %>%
as.numeric() %>% paste(collapse = ","))
print(a)
}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(ISLR)
str(Carseats)
ggplot(data = Carseats, aes(x = Advertising, y = Sales)) +
geom_point()
xyPlot <- ggplot(data = Carseats, aes(x = Advertising, y = Sales)) +
geom_point()
xyPlot
str(Carseats)
colnames(Carseats)
colnames(Carseats)
setdiff(colnames(Carseats), c("Sales", "Advertising"))
Carseats$Income
summary(Carseats$Income)
summary(Carseats$Income)[1]
summary(Carseats$Income)[2]
summary(Carseats$Income)[3]
summary(Carseats$Income)[4]
summary(Carseats$Income)[5]
Carseats <- Carseats %>%
mutate(IncomeF = ifelse(Income < summary(Carseats$Income)[2], "Q1",
ifelse(Income < summary(Carseats$Income)[3], "Q2",
ifelse(Income < summary(Carseats$Income)[5], "Q3", "Q4"))))
str(Carseats)
x <- Carseats$Income
generateQuartile <- function(x) {
summary(x)
}
x <- Carseats$Income
x
summary(x)
summary(x)[c(2,3,5)]
generateQuartile(x)
x <- Carseats$Income
generateQuartile <- function(x) {
return(summary(x)[c(2,3,5)])
}
generateQuartile(x)
generateQuartile <- function(x) {
return(summary(x)[c(2,3,5)])
}
generateQuartile(Carseats$Income)
generateQuartile <- function(x) {
return(summary(x)[c(2,3,5)])
}
Carseats <- Carseats %>%
mutate(IncomeF = ifelse(Income < generateQuartile(Carseats$Income)[1], "Q1",
ifelse(Income < generateQuartile(Carseats$Income)[2], "Q2",
ifelse(Income < generateQuartile(Carseats$Income)[3], "Q3", "Q4")))) %>%
mutate(AgeF = ifelse(Age < generateQuartile(Carseats$Age)[1], "Q1",
ifelse(Age < generateQuartile(Carseats$Age)[2], "Q2",
ifelse(Age < generateQuartile(Carseats$Age)[3], "Q3", "Q4")))) %>%
mutate(EducationF = ifelse(Education < generateQuartile(Carseats$Education)[1], "Q1",
ifelse(Education < generateQuartile(Carseats$Education)[2], "Q2",
ifelse(Education < generateQuartile(Carseats$Education)[3], "Q3", "Q4")))) %>%
mutate(PopulationF = ifelse(Population < generateQuartile(Carseats$Population)[1], "Q1",
ifelse(Population < generateQuartile(Carseats$Population)[2], "Q2",
ifelse(Population < generateQuartile(Carseats$Population)[3], "Q3", "Q4"))))
knitr::opts_chunk$set(echo = TRUE)
xyPlot <- ggplot(Carseats, aes(x = Advertising, y = Sales)) +
geom_point()
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(ISLR)
str(Carseats)
xyPlot <- ggplot(data = Carseats, aes(x = Advertising, y = Sales)) +
geom_point()
print(xyPlot)
colnames(Carseats)
setdiff(colnames(Carseats), c("Sales", "Advertising"))
xyPlot + facet_wrap(~ Urban) + ggtitle("by Urban")
xyPlot + facet_wrap(~ US) + ggtitle("by US")
generateQuartile <- function(x) {
return(summary(x)[c(2,3,5)])
}
Carseats <- Carseats %>%
mutate(IncomeF = ifelse(Income < generateQuartile(Carseats$Income)[1], "Q1",
ifelse(Income < generateQuartile(Carseats$Income)[2], "Q2",
ifelse(Income < generateQuartile(Carseats$Income)[3], "Q3", "Q4")))) %>%
mutate(AgeF = ifelse(Age < generateQuartile(Carseats$Age)[1], "Q1",
ifelse(Age < generateQuartile(Carseats$Age)[2], "Q2",
ifelse(Age < generateQuartile(Carseats$Age)[3], "Q3", "Q4")))) %>%
mutate(EducationF = ifelse(Education < generateQuartile(Carseats$Education)[1], "Q1",
ifelse(Education < generateQuartile(Carseats$Education)[2], "Q2",
ifelse(Education < generateQuartile(Carseats$Education)[3], "Q3", "Q4")))) %>%
mutate(PopulationF = ifelse(Population < generateQuartile(Carseats$Population)[1], "Q1",
ifelse(Population < generateQuartile(Carseats$Population)[2], "Q2",
ifelse(Population < generateQuartile(Carseats$Population)[3], "Q3", "Q4"))))
xyPlot <- ggplot(Carseats, aes(x = Advertising, y = Sales)) +
geom_point()
xyPlot + facet_wrap(~ IncomeF) + ggtitle("by Income")
xyPlot + facet_wrap(~ AgeF) + ggtitle("by Age")
xyPlot + facet_wrap(~ EducationF) + ggtitle("by Education")
xyPlot + facet_wrap(~ PopulationF) + ggtitle("by Population")
xyPlot + facet_wrap(~ IncomeF) + ggtitle("by Income") +
labs(subtitle = generateQuartile(Carseats$IncomeF))
generateQuartile(Carseats$IncomeF)
generateQuartile(Carseats$Income)
xyPlot + facet_wrap(~ IncomeF) + ggtitle("by Income") +
labs(subtitle = generateQuartile(Carseats$Income))
generateQuartile(Carseats$Income)
generateQuartile(Carseats$Income) %>% paste(collapse = TRUE)
generateQuartile(Carseats$Income) %>% paste(collapse = ",")
xyPlot + facet_wrap(~ IncomeF) + ggtitle("by Income") +
labs(subtitle = generateQuartile(Carseats$Income) %>% paste(collapse = ","))
knitr::opts_chunk$set(echo = FALSE)
str(Carseats)
Carseats <- Carseats %>%
filter(US == "Yes")
Carseats <- Carseats %>%
filter(US == "Yes") %>%
filter(Advertising != 0)
Carseats <- Carseats %>%
filter(US == "Yes") %>%
filter(Advertising ~= 0)
knitr::opts_chunk$set(echo = FALSE)
library(dplyr)
library(ggplot2)
library(ISLR)
Carseats <- Carseats %>%
filter(US == "Yes") %>%
filter(Advertising != 0)
str(Carseats)
rm(list=ls())
library(dplyr)
library(ggplot2)
library(ISLR)
# str(Carseats)
Carseats <- Carseats %>%
filter(US == "Yes") %>%
filter(Advertising != 0)
str(Carseats)
ggplot(data = Carseats, aes(x = Advertising, y = Sales)) +
geom_point() + stat_smooth(method="lm")
xyPlot + facet_wrap(~ Urban) + ggtitle("by Urban") + stat_smooth(method="lm")
rm(list=ls())
knitr::opts_chunk$set(echo = FALSE)
library(dplyr)
library(ggplot2)
library(ISLR)
# str(Carseats)
Carseats <- Carseats %>%
filter(US == "Yes") %>%
filter(Advertising != 0)
xyPlot <- ggplot(data = Carseats, aes(x = Advertising, y = Sales)) +
geom_point() + stat_smooth(method="lm")
print(xyPlot)
colnames(Carseats)
setdiff(colnames(Carseats), c("Sales", "Advertising"))
xyPlot + facet_wrap(~ Urban) + ggtitle("by Urban") + stat_smooth(method="lm")
xyPlot + facet_wrap(~ US) + ggtitle("by US") + stat_smooth(method="lm")
rm(list=ls())
knitr::opts_chunk$set(echo = FALSE)
library(dplyr)
library(ggplot2)
library(ISLR)
# str(Carseats)
Carseats <- Carseats %>%
filter(US == "Yes") %>%
filter(Advertising != 0)
xyPlot <- ggplot(data = Carseats, aes(x = Advertising, y = Sales)) +
geom_point() + stat_smooth(method="lm")
print(xyPlot)
colnames(Carseats)
setdiff(colnames(Carseats), c("Sales", "Advertising"))
xyPlot + facet_wrap(~ Urban) + ggtitle("by Urban") + stat_smooth(method="lm")
xyPlot + facet_wrap(~ US) + ggtitle("by US") + stat_smooth(method="lm")
generateQuartile <- function(x) {
return(summary(x)[c(2,3,5)])
}
Carseats <- Carseats %>%
mutate(IncomeF = ifelse(Income < generateQuartile(Carseats$Income)[1], "Q1",
ifelse(Income < generateQuartile(Carseats$Income)[2], "Q2",
ifelse(Income < generateQuartile(Carseats$Income)[3], "Q3", "Q4")))) %>%
mutate(AgeF = ifelse(Age < generateQuartile(Carseats$Age)[1], "Q1",
ifelse(Age < generateQuartile(Carseats$Age)[2], "Q2",
ifelse(Age < generateQuartile(Carseats$Age)[3], "Q3", "Q4")))) %>%
mutate(EducationF = ifelse(Education < generateQuartile(Carseats$Education)[1], "Q1",
ifelse(Education < generateQuartile(Carseats$Education)[2], "Q2",
ifelse(Education < generateQuartile(Carseats$Education)[3], "Q3", "Q4")))) %>%
mutate(PopulationF = ifelse(Population < generateQuartile(Carseats$Population)[1], "Q1",
ifelse(Population < generateQuartile(Carseats$Population)[2], "Q2",
ifelse(Population < generateQuartile(Carseats$Population)[3], "Q3", "Q4"))))
xyPlot <- ggplot(Carseats, aes(x = Advertising, y = Sales)) +
geom_point() + stat_smooth(method="lm")
xyPlot + facet_wrap(~ IncomeF) + ggtitle("by Income") +
labs(subtitle = generateQuartile(Carseats$Income) %>% paste(collapse = ","))
xyPlot + facet_wrap(~ AgeF) + ggtitle("by Age") +
labs(subtitle = generateQuartile(Carseats$Age) %>% paste(collapse = ","))
xyPlot + facet_wrap(~ EducationF) + ggtitle("by Education") +
labs(subtitle = generateQuartile(Carseats$Education) %>% paste(collapse = ","))
xyPlot + facet_wrap(~ PopulationF) + ggtitle("by Population") +
labs(subtitle = generateQuartile(Carseats$Population) %>% paste(collapse = ","))
